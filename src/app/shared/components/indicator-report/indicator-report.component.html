<p-dialog [(visible)]="isIndicatorModalShown" [modal]="true" [dismissableMask]="true" [draggable]="false"
    class="p-dialog-lg" (onHide)="close()">
    <ng-template pTemplate="header">
        <h1>{{ indicator?.name | translate }}</h1>
    </ng-template>
    <ng-template pTemplate="content">
        <ng-container *ngIf="isLoadingIndicators">
            <div class="skeleton-container">
                <app-loader />
            </div>
        </ng-container>

        <ng-container *ngIf="!isLoadingIndicators && indicator">
            <div class="grid w100">
                <div class="col-12 md:col-8">
                    <div class="bento-card">
                        <app-data-chart [data]="data" [xAxisLabel]="'pages.exams.form.exam_date' | translate"
                            [yAxisLabel]="indicator.unit!" />
                    </div>
                </div>
                <div class="col-12 md:col-4">
                    <div class="grid w100">
                        <div class="col-12">
                            <app-dashboard-card *ngIf="items[0]"
                                [title]="items[0] ? (('last_exam_at' | translate) + '<br/><h3 class=\'m0\'>' + (items[0]?.date | customDate) + '</h3>') : ('last_exam_not_found' | translate)"
                                [value]="items[0]?.value" [unit]="indicator.unit" />
                        </div>
                        <div class="col-12">
                            <div class="bento-card">
                                <strong class="text-center">
                                    {{ 'pages.dashboard.results_history' | translate }}
                                </strong>
                                <ng-container *ngTemplateOutlet="itemsList" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>
    </ng-template>
    <ng-template pTemplate="footer">
        <div class="grid w100">
            <div class="col-12 md:col-6">
                <button (click)="close()" type="button" class="btn btn-default mr-auto">
                    {{ 'close' | translate }}
                </button>
            </div>
        </div>
    </ng-template>
</p-dialog>


<ng-template #itemsList>
    <p-timeline [value]="items" align="left">
        <!-- <ng-template pTemplate="marker">
            <ng-icon name="phosphorArrowCircleRight" size="1.2rem" />
        </ng-template> -->
        <ng-template pTemplate="opposite" let-item>
            <small>{{ item.date | customDate }}</small>
        </ng-template>
        <ng-template pTemplate="content" let-item>
            <span>{{item.value}} <small>{{indicator?.unit}}</small></span>
        </ng-template>
    </p-timeline>
</ng-template>